# .github/workflows/update_rate.yml

name: Actualizar Cotizaci칩n P2P

on:
  # Se ejecuta cada 4 horas (0, 4, 8, 12, 16, 20)
  schedule:
    - cron: '0 */4 * * *' 
  # Permite ejecutar manualmente desde la interfaz de GitHub
  workflow_dispatch:

jobs:
  run_script:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4
      # Es importante hacer el checkout de la rama principal

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.x'

    - name: Install dependencies
      run: |
        # La 칰nica dependencia es requests
        pip install requests

    - name: Run Python script and generate JSON
      run: |
        # Ejecuta el script. Este genera/sobrescribe rate.json
        python binance_p2p_python.py

    - name: Commit and push changes
      # Esta acci칩n hace commit y push autom치ticamente del archivo generado
      uses: stefanzweifel/git-auto-commit-action@v5
      with:
        commit_message: '游뱄 Automated: Update P2P rate [skip ci]'
        # 游릭 CORRECCI칍N: Cambiado 'files' a 'file_pattern'
        file_pattern: 'rate.json'
